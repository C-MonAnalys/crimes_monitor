import{a as L}from"./chunk-UACPNK72.js";import{g as V}from"./chunk-WCJ3VB4Q.js";import{l as R,m as N}from"./chunk-MWBKWIFM.js";import{a as z}from"./chunk-Q6ESINKT.js";import{k as F,m as M,o as w}from"./chunk-GOJ2ZNOE.js";import{Aa as r,Ab as P,La as I,Nb as _,Ob as S,Pb as k,Qa as m,Rb as y,Ta as A,W as E,_b as T,bb as p,cb as n,db as i,eb as x,f as O,ia as b,ib as f,jb as u,ob as c,tb as C,yb as o,zb as v}from"./chunk-QQS62GLD.js";function B(e,t){e&1&&(n(0,"div",4),o(1," Carregando\u2026 "),i())}function U(e,t){if(e&1&&(n(0,"div",10),o(1),i()),e&2){let a=c();r(),P(" ",a.error," ")}}function Z(e,t){if(e&1&&(f(0),x(1,"p-chart",20),u()),e&2){let a=c(2);r(),p("data",a.perfChartData)("options",a.perfChartOpts)}}function j(e,t){e&1&&(n(0,"div",19),o(1,"Dados n\xE3o encontrados para desempenho por heur\xEDstica."),i())}function H(e,t){if(e&1&&(f(0),x(1,"p-chart",21),u()),e&2){let a=c(2);r(),p("data",a.videosSeriesData)("options",a.videosSeriesOpts)}}function G(e,t){e&1&&(n(0,"div",19),o(1,"S\xE9rie temporal indispon\xEDvel."),i())}function J(e,t){if(e&1&&(f(0),x(1,"p-chart",21),u()),e&2){let a=c(2);r(),p("data",a.metricsCompareData)("options",a.metricsCompareOpts)}}function K(e,t){e&1&&(n(0,"div",19),o(1,"Sem m\xE9tricas para comparar."),i())}function Q(e,t){if(e&1&&(f(0),n(1,"section",11)(2,"div",12)(3,"div",13),o(4,"Total de V\xEDdeos"),i(),n(5,"div",14),o(6),_(7,"number"),i()(),n(8,"div",12)(9,"div",13),o(10,"Opera\xE7\xF5es \xDAnicas"),i(),n(11,"div",14),o(12),_(13,"number"),i()(),n(14,"div",12)(15,"div",13),o(16,"Per\xEDodo"),i(),n(17,"div",14),o(18),i()(),n(19,"div",12)(20,"div",13),o(21,"M\xE9dia por Opera\xE7\xE3o"),i(),n(22,"div",14),o(23),_(24,"number"),i()()(),n(25,"section",15)(26,"div",16)(27,"h2",17),o(28,"Desempenho por Heur\xEDstica"),i(),m(29,Z,2,2,"ng-container",18)(30,j,2,0,"ng-template",null,0,y),i(),n(32,"div",16)(33,"h2",17),o(34,"V\xEDdeos por Per\xEDodo"),i(),m(35,H,2,2,"ng-container",18)(36,G,2,0,"ng-template",null,1,y),i()(),n(38,"section",16)(39,"h2",17),o(40,"Compara\xE7\xE3o de M\xE9tricas"),i(),m(41,J,2,2,"ng-container",18)(42,K,2,0,"ng-template",null,2,y),i(),n(44,"section",4)(45,"h2",17),o(46,"Resultados da Pesquisa"),i(),n(47,"div",19),o(48,"[lista/pagina\xE7\xE3o reaproveitada de /coletas/eventos]"),i()(),u()),e&2){let a=C(31),s=C(37),g=C(43),d=c();r(6),v(S(7,10,d.stats().totalVideos)),r(6),v(S(13,12,d.stats().uniqOps)),r(6),v(d.stats().period),r(5),v(k(24,14,d.stats().avgPerOp,"1.1-1")),r(6),p("ngIf",d.hasPerfData)("ngIfElse",a),r(6),p("ngIf",d.hasSeriesData)("ngIfElse",s),r(6),p("ngIf",d.hasCompareData)("ngIfElse",g)}}var q=class e{events=E(L);cdr=E(T);zone=E(A);search=b("");opFilter=b(null);isLoading=!0;error="";timedOut=!1;hasPerfData=!1;hasSeriesData=!1;hasCompareData=!1;stats=b({totalVideos:0,uniqOps:0,period:"\u2014",avgPerOp:0});perfChartData;perfChartOpts;videosSeriesData;videosSeriesOpts;metricsCompareData;metricsCompareOpts;ngOnInit(){return O(this,null,function*(){let t=this.events.getEvaluationsOverview();try{let a=yield z(t,5e3);this.zone.run(()=>{this.applyData(a),this.isLoading=!1,this.timedOut=!1,this.error="",this.cdr.markForCheck()})}catch(a){a?.message==="TIMEOUT"?(this.zone.run(()=>{this.timedOut=!0,this.isLoading=!1,this.error="",this.cdr.markForCheck()}),t.then(s=>{this.zone.run(()=>{this.applyData(s),this.timedOut=!1,this.cdr.markForCheck()})}).catch(s=>{this.zone.run(()=>{this.error="N\xE3o foi poss\xEDvel carregar os dados de avalia\xE7\xF5es.",this.cdr.markForCheck()})})):this.zone.run(()=>{this.error="N\xE3o foi poss\xEDvel carregar os dados de avalia\xE7\xF5es.",this.isLoading=!1,this.cdr.markForCheck()})}})}applyData(t){if(!t)return;this.stats.set({totalVideos:t.datasets.totalVideos,uniqOps:t.datasets.uniqueOperations,period:t.datasets.periodLabel,avgPerOp:t.datasets.avgVideosPerOperation});let a=(t.performance??[]).map(l=>l.label),s=(t.performance??[]).map(l=>l.metrics.accuracy),g=(t.performance??[]).map(l=>l.metrics.precision),d=(t.performance??[]).map(l=>l.metrics.recall),D=(t.performance??[]).map(l=>l.metrics.f1);this.hasPerfData=a.length>0,this.hasCompareData=this.hasPerfData,this.perfChartData={labels:a,datasets:[{label:"Acur\xE1cia",data:s,backgroundColor:"#3b82f6"},{label:"Precis\xE3o",data:g,backgroundColor:"#10b981"},{label:"Revoca\xE7\xE3o",data:d,backgroundColor:"#f59e0b"},{label:"F1-Score",data:D,backgroundColor:"#8b5cf6"}]},this.perfChartOpts={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,max:1,ticks:{callback:l=>l*100+"%"}}}};let h=t.videosByPeriod??{labels:[],values:[]};this.hasSeriesData=Array.isArray(h.labels)&&h.labels.length>0,this.videosSeriesData={labels:h.labels,datasets:[{label:"V\xEDdeos coletados",data:h.values,tension:.3,borderColor:"#8b5cf6",backgroundColor:"rgba(139,92,246,.12)",fill:!0}]},this.videosSeriesOpts={responsive:!0,maintainAspectRatio:!1},this.metricsCompareData={labels:a,datasets:[{label:"Acur\xE1cia",data:s,borderColor:"#3b82f6"},{label:"Precis\xE3o",data:g,borderColor:"#10b981"},{label:"Revoca\xE7\xE3o",data:d,borderColor:"#f59e0b"},{label:"F1-Score",data:D,borderColor:"#8b5cf6"}]},this.metricsCompareOpts={responsive:!0,maintainAspectRatio:!1}}static \u0275fac=function(a){return new(a||e)};static \u0275cmp=I({type:e,selectors:[["app-avaliacoes-eventos"]],decls:9,vars:3,consts:[["noPerf",""],["noSeries",""],["noCompare",""],[1,"space-y-6"],[1,"bg-white","rounded-xl","border","border-slate-200","p-6"],[1,"text-2xl","font-bold","text-slate-900"],[1,"text-slate-600","mt-1"],["class","bg-white rounded-xl border border-slate-200 p-6",4,"ngIf"],["class","bg-white rounded-xl border border-slate-200 p-6 text-red-600",4,"ngIf"],[4,"ngIf"],[1,"bg-white","rounded-xl","border","border-slate-200","p-6","text-red-600"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"bg-white","border","border-slate-200","rounded-xl","p-4"],[1,"text-slate-500","text-sm"],[1,"text-2xl","font-bold"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-white","rounded-xl","border","border-slate-200","p-6","h-96"],[1,"font-semibold","text-slate-900","mb-3"],[4,"ngIf","ngIfElse"],[1,"text-slate-500"],["type","bar","height","100%",3,"data","options"],["type","line","height","100%",3,"data","options"]],template:function(a,s){a&1&&(n(0,"div",3)(1,"header",4)(2,"h1",5),o(3,"Avalia\xE7\xE3o de Desempenho \u2014 Eventos"),i(),n(4,"p",6),o(5,"Consolida estat\xEDsticas dos datasets e compara\xE7\xE3o de heur\xEDsticas/modelos."),i()(),m(6,B,2,0,"div",7)(7,U,2,1,"div",8)(8,Q,49,17,"ng-container",9),i()),a&2&&(r(6),p("ngIf",s.isLoading),r(),p("ngIf",!s.isLoading&&s.error),r(),p("ngIf",!s.isLoading&&!s.error))},dependencies:[w,F,V,N,R,M],encapsulation:2,changeDetection:0})};export{q as AvaliacoesEventosComponent};
